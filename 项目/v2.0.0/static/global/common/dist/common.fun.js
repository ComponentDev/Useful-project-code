define("static/global/common/2.0.0/common.fun",["static/global/common/2.0.0/dialog","static/global/common/2.0.0/slider"],function(a,b,c){var d={};XD={};var e="http://www.xidibuy.com";a("static/global/common/2.0.0/dialog.js")($),a("static/global/common/2.0.0/slider.js")($);var f=$("#form_token");TOKEN_KEY=f.attr("name"),TOKEN_VAL=f.val(),XD.Datas={topCart:"#top_cart",cartMax:3,skuGoodsNums:0,cartNum:0},d.Actions={getSkuGoodsNums:function(){$.ajax({type:"GET",url:e+"/cart/getSkuGoodsNums?jsoncallback=?",dataType:"json",async:!1,success:function(a){XD.Datas.skuGoodsNums=parseInt(a),isNaN(XD.Datas.skuGoodsNums)&&(XD.Datas.skuGoodsNums=0)}})},getCartNum:function(){$.ajax({type:"GET",url:e+"/cart/getGoodsNum?jsoncallback=?",dataType:"json",async:!1,success:function(a){XD.Datas.cartNum=parseInt(a),isNaN(XD.Datas.cartNum)?XD.Datas.cartNum=0:XD.Datas.cartNum>99&&(XD.Datas.cartNum="99+"),0!=XD.Datas.cartNum&&($(XD.Datas.topCart).html(XD.Datas.cartNum),$(".userCart-text").removeClass("userCart-text").addClass("userCart-text-full"))}})},getCartGoods:function(a){$.ajax({type:"GET",url:e+"/Cart/cList?jsoncallback=?",dataType:"json",async:!1,success:function(b){var b="string"==typeof b?$.parseJSON(b):b;0==b.code&&a&&a(b)},error:function(){}})},isLogin:function(){var a=0;return $.ajax({type:"POST",url:e+"/User/ajaxIsLogin",async:!1,success:function(b){var b="string"==typeof b?$.parseJSON(b):b;0==b.code&&(a=1)}}),a},sendMessage:function(a,b){$.ajax({type:"POST",url:e+"/Message/send",data:a,async:!1,success:function(c){var c="string"==typeof c?$.parseJSON(c):c;0==c.code?(a.create_time=c.data.create_time,a.avator=c.data.avatar,d.Methods.sendSuccess("发送留言成功！"),b&&b(a)):d.Methods.sendError("发送留言失败！")},error:function(){d.Methods.sendError("发送留言失败！")}})}},d.Methods={uploadImage:function(a){function b(a){var b=$('input[name="getTokenType"]',a).val();$.ajax({type:"POST",url:e+"/Feedback/getToken",data:{type:b},async:!1,success:function(b){var b="string"==typeof b?$.parseJSON(b):b;a.find("input[name=token]").val(b.token)}})}function c(){var a=$("[data-class=upLoadImageButtonBox]",g);i.length>=5?a.hide():a.show()}var d=$("[data-action=upLoadImageButton]"),f=null,g=null,h=null,i=[];return d.live("change",function(){return document.domain="xidibuy.com",f=$(this).parent("[data-class=upLoadImageButtonBox]"),g=f.parent("[data-class=upLoadImageOuter]"),h=d.parents("form[name=upLoadImageForm]"),b(h),h.attr("action",IMAGE_DOMAIN+"upload").submit(),!1}),window.upCallback=function(b){if("object"==typeof b&&0==b.code){$(a).html("");var d=b.data.key[0],e='<li class="certificate-item mr12 pr fl" data-class="upLoadImageBox" data-uri="'+d+'">'+'	<img src="'+IMAGE_DOMAIN+d+'" width="58" height="58">'+'	<div class="certificate-oper hide pa" data-action="removeUpLoadImage">'+'		<span class="icon-remove sprites"></span>'+"	</div>"+"</li>";i.push(d),g[0]?(f.before(e),c()):$("[data-class=imagePreview]").attr("src",IMAGE_DOMAIN+d)}else{if(b.msg)var h=b.msg;else var h="上传失败";$(a).html(h)}},$("[data-action=removeUpLoadImage]").live("click",function(){var a=$(this).parent("[data-class=upLoadImageBox]"),b=a.attr("data-uri");return a.fadeOut(function(){i.splice($.inArray(b,i),1),a.remove(),c()}),!1}),i},formatGoodsNum:function(a,b){var b="string"==typeof b?$(b):b,a="string"==typeof a?$(a):a;a.parents(".addCartOperBox").next();var c=a.prev(),d=a.next(),e=1,f=a.attr("data-max");f=parseInt(f),g=isNaN(f)?1:f;var g=a.val();return g=parseInt(g),g=isNaN(g)?1:g,g==e&&g==f?(a.attr("disabled",!0),c.addClass("minus-disabled"),d.addClass("plus-disabled")):e>=g?(g=e,c.addClass("minus-disabled"),d.removeClass("plus-disabled")):g>=f?(g=f,c.removeClass("minus-disabled"),d.addClass("plus-disabled")):(c.removeClass("minus-disabled"),d.removeClass("plus-disabled")),a.val(g),b&&b.attr("data-cat-num",g),g},isGoodsNumInMax:function(a,b){var a="string"==typeof a?$(a):a,c=a.val();c=parseInt(c),c=isNaN(c)?1:c;var e=a.attr("data-max");e=parseInt(e),e=isNaN(e)?1:e;var f=a.prev(),g=a.next();g.hasClass("plus-disabled")&&c>=e?d.Methods.showNumNotice(a,b):(f.hasClass("minus-disabled")||e>=c)&&d.Methods.hideNumNotice(a,!0)},enterStatus:function(){},showNumNotice:function(a,b){var c=a.parent(".addCartOperBox"),e=a.val();e=parseInt(e),e=isNaN(e)?1:e;var f=a.attr("data-max");f=parseInt(f),f=isNaN(f)?1:f,e>=f&&c.next().stop(!0,!0).show().find("[data-class=max-num]").text(f),b&&d.Methods.hideNumNotice(a)},hideNumNotice:function(a,b){var c=a.parents(".addCartOperBox");return b?(c.next().hide(),!1):(setTimeout(function(){c.next().hide()},1500),void 0)},sendSuccess:function(a,b){var c=null;if(b)var d='<span class="icon-error-21" style="float: left;"></span>';else var d='<span class="icon-success-21" style="float: left;"></span>';var e='<div class="clearfix">'+d+'    <p style="padding-left: 12px; font-size: 14px; float: left;">'+a+"</p>"+"</div>";$.dialog_block({title:" ",hideCloseButton:!0,content:e}),c=setTimeout(function(){$.dialog_unblock(),clearTimeout(c)},2e3)},sendError:function(a){d.Methods.sendSuccess(a,!0)},countdown:function(a,b,c){function d(){var b=a-j;if(b>0&&a>b){j++;var d=parseInt(b/86400);d=10>d?"0"+d:d,b%=86400;var k=parseInt(b/3600);k=10>k?"0"+k:k,b%=3600;var l=parseInt(b/60);l=10>l?"0"+l:l,b%=60;var m=b;m=10>m?"0"+m:m}else{var d="00",k="00",l="00",m="00";c&&c(),clearInterval(i)}e.text(d),f.text(k),g.text(l),h.text(m)}var b="undefined"==typeof b?$("body"):b;b="string"==typeof b?$(b):b;var a=a,e=$("[data-class=days]",b),f=$("[data-class=hours]",b),g=$("[data-class=minutes]",b),h=$("[data-class=seconds]",b),i=null,j=1;i=setInterval(d,1e3)},checkbox:function(a,b){var a="string"==typeof a?$(a):a;if("check"==b)a.each(function(){var b=$(this),c=$("input",a);b.addClass("checkbox").removeClass("uncheckbox"),c[0]&&c.attr("checked",!0)});else if("uncheck"==b)a.each(function(){var b=$(this),c=$("input",a);b.addClass("uncheckbox").removeClass("checkbox"),c[0]&&c.attr("checked",!1)});else{var c=$("input",a);a.toggleClass("checkbox").toggleClass("uncheckbox"),c[0]&&c.prop("checked")?c.attr("checked",!1):c[0]&&c.attr("checked",!0)}},parseUrl:function(a){var b=/(\w+)=(\w+)/gi,c={};return a.replace(b,function(a,b,d){c[b]=d}),c},detect:function(a){return 13==a||8==a||46==a||a>=37&&40>=a||a>=48&&57>=a||a>=96&&105>=a?!0:void 0},setCookie:function(a,b,c){if(c!==!1){var d=new Date;c?d.setDate(d.getDate()+c):d.setDate(d.getDate()),document.cookie=a+"="+b+";expires="+d+";path=/"}else document.cookie=a+"="+b},getCookie:function(a){var b=document.cookie.split("; "),c=0;for(c=0;c<b.length;c++){var d=b[c].split("=");if(d[0]==a)return d[1]}return""},removeCookie:function(a){d.Methods.setCookie(a,"a",-1)}},d.Check={string:function(a,b){var c=null;$(document).on("focus",a,function(){var a=$(this);d.Check.hideError(a)}).on("blur",a,function(){var a=$(this);b.isCheck=!0,d.Check.check(a,b)}),$(document).on("keyup",a,function(){var a=$(this);clearTimeout(c),c=setTimeout(function(){clearTimeout(c),b.isCheck=!1,d.Check.check(a,b)},50)})},check:function(a,b){function c(c){l=!1,b.isCheck&&d.Check.showError(a,c,b.selector),b.isFocus&&a.focus()}function e(){l=!0,d.Check.hideError(a,b.selector)}var f={type:"string",isCheck:!0,isFocus:!1,required:"此项为必填项",format:"格式错误，请重新填写"},b=$.extend({},f,b||{}),a="string"==typeof a?$(a):a,g=a.attr("data-required"),h=a.attr("data-min");h=parseInt(h),h=isNaN(h)?0:h;var i=a.attr("data-max");i=parseInt(i),i=isNaN(i)?1/0:i;var j=a.val();j=$.trim(j);var k=j.length,l=!0;if(""===j&&g)return c(b.required),!1;if(""!==j&&(h>k||k>i))return c(b.format),!1;if(""!==j&&"number"===b.type){var m=d.Regular.isNumber(j);if(!m)return c(b.format),!1}else if(""!==j&&"email"===b.type){var m=d.Regular.isEmail(j);if(!m)return c(b.format),!1}else if(""!==j&&"mobile"===b.type){var m=d.Regular.isMobile(j);if(!m)return c(b.format),!1}return l?(e(),!0):void 0},showError:function(a,b,c){var a="string"==typeof a?$(a):a;if(a[0]){var d=a.attr("name"),d=d?d:a.attr("id"),e=c?$(c):$("#error-warning-"+d);a.addClass("textError"),e.show().html(b)}},hideError:function(a,b){var a="string"==typeof a?$(a):a;if(a[0]){var c=a.attr("name"),c=c?c:a.attr("id"),d=b?$(b):$("#error-warning-"+c);a.removeClass("textError"),d.hide().html("")}}},d.Regular={isEmail:function(a){var b=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return b.test(a)},isMobile:function(a){var b=/^(13[0-9]{9})|(14[0-9]{9})|(15[0-9]{9})|(18[0-9]{9})$/;return b.test(a)},isUrl:function(a){var b=/((http[s]?|ftp):\/\/)?[^\/\.]+?\..+\w$/i;return b.test(a)},isNumber:function(a){var b=/^[0-9]*$/;return b.test(a)}},d.passCheck={charMode:function(a){return a>=48&&57>=a?1:a>=65&&90>=a?2:a>=97&&122>=a?4:8},bitTotal:function(a){var b=0;for(i=0;4>i;i++)1&a&&b++,a>>>=1;return b},checkStrong:function(a){if(a.length<=4)return 0;for(Modes=0,i=0;i<a.length;i++)Modes|=d.passCheck.charMode(a.charCodeAt(i));return d.passCheck.bitTotal(Modes)},pwStrength:function(a,b,c){if(null==a||""==a)b.hide(),c.text(" ");else{var e=d.passCheck.checkStrong(a);switch(e){case 0:case 1:b.show().addClass("passLevel-low").removeClass("passLevel-medium").removeClass("passLevel-high"),c.text("密码等级：低");break;case 2:b.show().addClass("passLevel-medium").removeClass("passLevel-low").removeClass("passLevel-high"),c.text("密码等级：中");break;default:b.show().addClass("passLevel-high").removeClass("passLevel-medium").removeClass("passLevel-low"),c.text("密码等级：高")}}}},c.exports=d});
